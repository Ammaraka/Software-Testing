<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>VirtualReality: Aurora.DataManager.LegacyMigration Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><b>Aurora</b>      </li>
      <li><a class="el" href="../../d4/d7e/namespaceAurora_1_1DataManager.html">DataManager</a>      </li>
      <li><a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html">Aurora.DataManager.LegacyMigration</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#properties">Properties</a>  </div>
  <div class="headertitle">
<h1>Aurora.DataManager.LegacyMigration Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Aurora::DataManager::LegacyMigration" -->
<p>The <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> theory is based on the ruby on rails concept. Each database driver is going to be allowed to have files in Resources that specify the database migrations. They will be of the form:  
<a href="#_details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Aurora.DataManager.LegacyMigration:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.png" usemap="#Aurora.DataManager.LegacyMigration_map" alt=""/>
  <map id="Aurora.DataManager.LegacyMigration_map" name="Aurora.DataManager.LegacyMigration_map">
<area href="../../df/dcf/classOpenSim_1_1Data_1_1MySQL_1_1MySqlMigration.html" alt="OpenSim.Data.MySQL.MySqlMigration" shape="rect" coords="0,56,232,80"/>
</map>
</div>

<p><a href="../../dd/d40/classAurora_1_1DataManager_1_1LegacyMigration-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a7cfff059271f9c3d19ff2a8ed5e1e125">Initialize</a> (DbConnection conn, Assembly assem, string type, string subtype)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Must be called after creating with the parameterless constructor. NOTE that the <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> class now doesn't access database in any way during initialization. Specifically, it won't check if the [migrations] table exists. Such checks are done later: automatically on Update(), or you can explicitly call InitMigrationsTable().  <a href="#a7cfff059271f9c3d19ff2a8ed5e1e125"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa5896fb0b0907600808ce9b5d4cc8fe1"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::InitMigrationsTable" ref="aa5896fb0b0907600808ce9b5d4cc8fe1" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>InitMigrationsTable</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a8dee0478ac40162cc4ffb96e9a2308e5">LegacyMigration</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Have the parameterless constructor just so we can specify it as a generic parameter with the new() constraint. Currently this is only used in the tests. A <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> instance created this way must be then initialized with <a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a7cfff059271f9c3d19ff2a8ed5e1e125" title="Must be called after creating with the parameterless constructor. NOTE that the Migration class now d...">Initialize()</a>. Regular creation should be through the parameterized constructors.  <a href="#a8dee0478ac40162cc4ffb96e9a2308e5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac1e827b3621131b47e6a69ba9879024b"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::LegacyMigration" ref="ac1e827b3621131b47e6a69ba9879024b" args="(DbConnection conn, Assembly assem, string subtype, string type)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>LegacyMigration</b> (DbConnection conn, Assembly assem, string subtype, string type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a59353d67c16f55f400f04c0379cc5dd7"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::LegacyMigration" ref="a59353d67c16f55f400f04c0379cc5dd7" args="(DbConnection conn, Assembly assem, string type)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>LegacyMigration</b> (DbConnection conn, Assembly assem, string type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abaa733f498a803a2912be05370993fd7"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::Update" ref="abaa733f498a803a2912be05370993fd7" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>Update</b> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a3333a78b4f49b64a5e5eb9238da2291b">ExecuteScript</a> (DbConnection conn, string[] script)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Executes a script, possibly in a database-specific way. It can be redefined for a specific DBMS, if necessary. Specifically, to avoid problems with proc definitions in <a class="el" href="../../dc/d07/namespaceAurora_1_1DataManager_1_1MySQL.html">MySQL</a>, we must use MySqlScript class instead of just DbCommand. We don't want to bring <a class="el" href="../../dc/d07/namespaceAurora_1_1DataManager_1_1MySQL.html">MySQL</a> references here, so instead define a MySQLMigration class in <a class="el" href="../../df/d7b/namespaceOpenSim_1_1Data_1_1MySQL.html">OpenSim.Data.MySQL</a>.  <a href="#a3333a78b4f49b64a5e5eb9238da2291b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7dad8d4f78a5ed3c2c7dc73867f9c616"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::ExecuteScript" ref="a7dad8d4f78a5ed3c2c7dc73867f9c616" args="(DbConnection conn, string sql)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>ExecuteScript</b> (DbConnection conn, string sql)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0d929cee468af74dd3401074001d2bea"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::ExecuteScript" ref="a0d929cee468af74dd3401074001d2bea" args="(string[] script)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>ExecuteScript</b> (string[] script)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3fbd366b94172fcc21aa85de33108630"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::ExecuteScript" ref="a3fbd366b94172fcc21aa85de33108630" args="(string sql)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>ExecuteScript</b> (string sql)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a719582a58766e3a46147320ec939f300"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::FindVersion" ref="a719582a58766e3a46147320ec939f300" args="(DbConnection conn, string type)" -->
virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><b>FindVersion</b> (DbConnection conn, string type)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af1e92717cd41f86b65f4cad3de09700e"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::_assem" ref="af1e92717cd41f86b65f4cad3de09700e" args="" -->
Assembly&nbsp;</td><td class="memItemRight" valign="bottom"><b>_assem</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ca7ccb1d427fa5d0445765b31576b61"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::_conn" ref="a6ca7ccb1d427fa5d0445765b31576b61" args="" -->
DbConnection&nbsp;</td><td class="memItemRight" valign="bottom"><b>_conn</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8e31b9a66715424bb87a44aca76bad2a"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::_type" ref="a8e31b9a66715424bb87a44aca76bad2a" args="" -->
string&nbsp;</td><td class="memItemRight" valign="bottom"><b>_type</b></td></tr>
<tr><td colspan="2"><h2><a name="properties"></a>
Properties</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9937f866f51d9e1a062003483cc8d00c"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::Version" ref="a9937f866f51d9e1a062003483cc8d00c" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>Version</b><code> [get, set]</code></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> theory is based on the ruby on rails concept. Each database driver is going to be allowed to have files in Resources that specify the database migrations. They will be of the form: </p>
<p>001_Users.sql 002_Users.sql 003_Users.sql 001_Prims.sql 002_Prims.sql ...etc...</p>
<p>When a database driver starts up, it specifies a resource that needs to be brought up to the current revision. For instance:</p>
<p><a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> um = new <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a>(DbConnection, Assembly, "Users"); um.Update();</p>
<p>This works out which version Users is at, and applies all the revisions past it to it. If there is no users table, all revisions are applied in order. Consider each future migration to be an incremental roll forward of the tables in question.</p>
<p>Assembly must be specifically passed in because otherwise you get the assembly that Migration.cs is part of, and what you really want is the assembly of your database class. /summary&gt; </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8dee0478ac40162cc4ffb96e9a2308e5"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::LegacyMigration" ref="a8dee0478ac40162cc4ffb96e9a2308e5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Aurora.DataManager.LegacyMigration.LegacyMigration </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Have the parameterless constructor just so we can specify it as a generic parameter with the new() constraint. Currently this is only used in the tests. A <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> instance created this way must be then initialized with <a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a7cfff059271f9c3d19ff2a8ed5e1e125" title="Must be called after creating with the parameterless constructor. NOTE that the Migration class now d...">Initialize()</a>. Regular creation should be through the parameterized constructors. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a3333a78b4f49b64a5e5eb9238da2291b"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::ExecuteScript" ref="a3333a78b4f49b64a5e5eb9238da2291b" args="(DbConnection conn, string[] script)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Aurora.DataManager.LegacyMigration.ExecuteScript </td>
          <td>(</td>
          <td class="paramtype">DbConnection&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string[]&nbsp;</td>
          <td class="paramname"> <em>script</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Executes a script, possibly in a database-specific way. It can be redefined for a specific DBMS, if necessary. Specifically, to avoid problems with proc definitions in <a class="el" href="../../dc/d07/namespaceAurora_1_1DataManager_1_1MySQL.html">MySQL</a>, we must use MySqlScript class instead of just DbCommand. We don't want to bring <a class="el" href="../../dc/d07/namespaceAurora_1_1DataManager_1_1MySQL.html">MySQL</a> references here, so instead define a MySQLMigration class in <a class="el" href="../../df/d7b/namespaceOpenSim_1_1Data_1_1MySQL.html">OpenSim.Data.MySQL</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>conn</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>script</em>&nbsp;</td><td>Array of strings, one-per-batch (often just one)</td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../df/dcf/classOpenSim_1_1Data_1_1MySQL_1_1MySqlMigration.html#a75e4d20a953730f548cdea4133c599a6">OpenSim.Data.MySQL.MySqlMigration</a>.</p>

</div>
</div>
<a class="anchor" id="a7cfff059271f9c3d19ff2a8ed5e1e125"></a><!-- doxytag: member="Aurora::DataManager::LegacyMigration::Initialize" ref="a7cfff059271f9c3d19ff2a8ed5e1e125" args="(DbConnection conn, Assembly assem, string type, string subtype)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Aurora.DataManager.LegacyMigration.Initialize </td>
          <td>(</td>
          <td class="paramtype">DbConnection&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Assembly&nbsp;</td>
          <td class="paramname"> <em>assem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>subtype</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Must be called after creating with the parameterless constructor. NOTE that the <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> class now doesn't access database in any way during initialization. Specifically, it won't check if the [migrations] table exists. Such checks are done later: automatically on Update(), or you can explicitly call InitMigrationsTable(). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>conn</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>assem</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>subtype</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Aurora/DataManager/Legacy/LegacyMigration.cs</li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
